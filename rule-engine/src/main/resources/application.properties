spring.application.name=rule-engine
server.port=8082

# Database Configuration
spring.datasource.url=jdbc:postgresql://${DB_HOST:localhost}:${DB_PORT:5432}/${DB_NAME:rule_engine_db}?sslmode=require
spring.datasource.username=${DB_USERNAME:postgres}
spring.datasource.password=${DB_PASSWORD:password}
spring.datasource.driver-class-name=org.postgresql.Driver
spring.datasource.hikari.maximum-pool-size=10
spring.datasource.hikari.minimum-idle=5
spring.datasource.hikari.connection-timeout=20000
spring.datasource.hikari.idle-timeout=300000

# JPA Configuration
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=true
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.PostgreSQLDialect
spring.jpa.properties.hibernate.format_sql=true

# Redis Configuration
spring.data.redis.host=${REDIS_HOST:localhost}
spring.data.redis.port=${REDIS_PORT:6379}
spring.data.redis.password=${REDIS_PASSWORD:}
spring.data.redis.timeout=2000ms
spring.data.redis.connect-timeout=2000ms

# Cache Configuration
cache.ttl=${CACHE_TTL:3600}

# Resilience4j Configuration
resilience4j.retry.instances.database.max-attempts=3
resilience4j.retry.instances.database.wait-duration=1s
resilience4j.retry.instances.database.retry-exceptions=org.springframework.dao.DataAccessException,java.sql.SQLException
resilience4j.retry.instances.database.ignore-exceptions=com.anupam.ruleengine.exception.VendorRuleNotFoundException
resilience4j.retry.instances.database.enable-exponential-backoff=true
resilience4j.retry.instances.database.exponential-backoff-multiplier=2

# Circuit Breaker Configuration
resilience4j.circuitbreaker.instances.database.failure-rate-threshold=50
resilience4j.circuitbreaker.instances.database.minimum-number-of-calls=5
resilience4j.circuitbreaker.instances.database.wait-duration-in-open-state=30s
resilience4j.circuitbreaker.instances.database.sliding-window-size=10

# Enable retry event logging
logging.level.io.github.resilience4j.retry=DEBUG
logging.level.io.github.resilience4j.circuitbreaker=DEBUG

# Logging
logging.level.com.anupam.ruleengine=DEBUG
logging.level.org.springframework.jdbc=DEBUG
logging.level.com.zaxxer.hikari=DEBUG
logging.level.org.postgresql=DEBUG
logging.level.org.springframework.boot.autoconfigure.jdbc=DEBUG